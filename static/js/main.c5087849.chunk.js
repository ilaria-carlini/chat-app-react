(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{195:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(18),r=a.n(c),s=a(298),i=a(299),o=a(297),l=a(2);function u(e){return Object(l.jsx)(o.a,{sx:{width:"100%"},children:Object(l.jsx)(s.a,{position:"static",children:Object(l.jsx)(i.a,{})})})}var p=a(71),d=a(21),j=a(20),h=a.n(j),b=a(39),x=a(14),m=a(295),O=a(303),f=a(279),g=a(288),v=a(146),y=a.n(v),w=a(301),k=a(300),C=a(154),T=a(296),S=a(60),E=a.n(S),I=a(304),A=Object(C.a)();function D(){var e=Object(d.f)(),t=Object(n.useState)(!1),a=Object(x.a)(t,2),c=a[0],r=a[1],s=function(){var t=Object(b.a)(h.a.mark((function t(a){var n,c;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r(!0),a.preventDefault(),""!==(n=new FormData(a.currentTarget)).get("email")&&""!==n.get("password")&&(c={username:n.get("email"),password:n.get("password")},fetch("".concat("https://chat-server-challenge.herokuapp.com","/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(c),credentials:"include"}).then((function(e){return e.json().then((function(t){return e.data=t,e}))})).then((function(t){if(200!==t.status)throw new Error(t.status);E.a.set("AUTH",t.data.id),r(!1),e.push("/")})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(l.jsx)(T.a,{theme:A,children:Object(l.jsxs)(k.a,{component:"main",maxWidth:"xs",children:[Object(l.jsx)(f.a,{}),Object(l.jsxs)(o.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(l.jsx)(m.a,{sx:{m:1,bgcolor:"secondary.main"},children:Object(l.jsx)(y.a,{})}),Object(l.jsx)(w.a,{component:"h1",variant:"h5",children:"Authentication"}),Object(l.jsxs)(o.a,{component:"form",onSubmit:s,noValidate:!0,sx:{mt:1},children:[Object(l.jsx)(g.a,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0}),Object(l.jsx)(g.a,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password"}),Object(l.jsx)(O.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Sign In"}),c&&Object(l.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)"},children:Object(l.jsx)(I.a,{})})]})]})]})})}var G=a(104),R=a(155),U=a(5),H=a(290),L=a(306),P=a(302),W=a(292),z=a(281),J=a(309),N=a(308),q=a(307),B=a(6),M=a(121),F=a(33),V=a(291),K=a(150),Y=a.n(K),Z=a(305),Q=a(151),X=a.n(Q),$=a(119),_=a(116),ee=a.n(_),te=["children","value","index"],ae="https://chat-server-challenge.herokuapp.com",ne=Object(B.a)("div")((function(e){var t,a=e.theme;return t={position:"relative",borderRadius:a.shape.borderRadius,backgroundColor:Object(M.a)(a.palette.common.black,.05),"&:hover":{backgroundColor:Object(M.a)(a.palette.common.black,.08)},marginRight:a.spacing(2),marginLeft:0,width:"100%"},Object(U.a)(t,a.breakpoints.up("sm"),{marginLeft:a.spacing(3),width:"auto"}),Object(U.a)(t,"border","alpha(theme.palette.common.black, 1) solid"),t})),ce=Object(B.a)("div")((function(e){return{padding:e.theme.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}})),re=Object(B.a)(F.c)((function(e){var t=e.theme;return{color:"inherit","& .MuiInputBase-input":Object(U.a)({padding:t.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(t.spacing(4),")"),transition:t.transitions.create("width"),width:"100%"},t.breakpoints.up("md"),{width:"20ch"})}}));function se(e){var t=e.children,a=e.value,n=e.index,c=Object(R.a)(e,te);return Object(l.jsx)("div",Object(G.a)(Object(G.a)({role:"tabpanel",hidden:a!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n)},c),{},{children:a===n&&Object(l.jsx)(o.a,{sx:{p:2},children:Object(l.jsx)(w.a,{children:t})})}))}function ie(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function oe(){var e=this,t=Object(d.f)();null==E.a.get("AUTH")&&t.push("/login");var a=Object(n.useState)(0),c=Object(x.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)(null),u=Object(x.a)(i,2),p=u[0],j=u[1],O=Object(n.useState)(null),f=Object(x.a)(O,2),g=f[0],v=f[1];function y(e){return k.apply(this,arguments)}function k(){return(k=Object(b.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ae,"/contacts?q=").concat(t),{method:"GET",headers:{"content-type":"application/json"},credentials:"include"});case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,j(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(n.useEffect)((function(){function e(){return(e=Object(b.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ae,"/profile"),{method:"GET",headers:{"content-type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,v(a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}y(""),function(){e.apply(this,arguments)}(),Object($.a)(ae).on("chat message",(function(){y()}))}),[]);var C=function(){var e=Object(b.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("/chat/".concat(a.id));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(b.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),null!=E.a.get("AUTH")&&(E.a.remove("AUTH"),t.push("/login"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(l.jsxs)(o.a,{sx:{width:"100%"},children:[Object(l.jsx)("div",{style:{position:"absolute",right:"0",top:"4px",color:"white"},children:Object(l.jsx)(Z.a,{size:"large",onClick:T,color:"inherit",children:Object(l.jsx)(ee.a,{})})}),Object(l.jsx)(o.a,{sx:{borderBottom:1,borderColor:"divider"},children:Object(l.jsxs)(H.a,{value:r,onChange:function(e,t){s(t)},"aria-label":"basic tabs example",variant:"fullWidth",children:[Object(l.jsx)(L.a,Object(G.a)({label:"Contacts"},ie(0))),Object(l.jsx)(L.a,Object(G.a)({label:"Profile"},ie(1)))]})}),Object(l.jsxs)(se,{value:r,index:0,children:[Object(l.jsxs)(ne,{onChange:function(e){y(e.target.value)},children:[Object(l.jsx)(ce,{children:Object(l.jsx)(Y.a,{})}),Object(l.jsx)(re,{placeholder:"Search\u2026",inputProps:{"aria-label":"search"}})]}),p&&Object(l.jsx)(P.a,{sx:{width:"100%",bgcolor:"background.paper"},children:p.map((function(t){return Object(l.jsxs)(z.a,{onClick:C.bind(e,t),children:[Object(l.jsx)(q.a,{children:Object(l.jsx)(m.a,{alt:t.username,src:t.avatar})}),Object(l.jsx)(N.a,{primary:t.name+" "+t.surname}),Object(l.jsx)(V.a,{badgeContent:t.history.unreadCount,color:"primary",children:Object(l.jsx)(Z.a,{size:"large","aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",color:"inherit",children:Object(l.jsx)(X.a,{})})})]},t.id)}))})]}),Object(l.jsx)(se,{value:r,index:1,children:g&&Object(l.jsxs)(P.a,{sx:{width:"100%",bgcolor:"background.paper"},children:[Object(l.jsx)(m.a,{alt:g.username,src:g.avatar,sx:{width:100,height:100},style:{margin:"10px auto 30px auto"}}),Object(l.jsx)(w.a,{align:"center",variant:"h5",children:g.name+" "+g.surname}),Object(l.jsx)(W.a,{children:Object(l.jsx)(N.a,{primary:g.username,secondary:"Username"})},g.username),Object(l.jsx)(J.a,{}),Object(l.jsx)(W.a,{children:Object(l.jsx)(N.a,{primary:g.email,secondary:"Email"})},g.email)]})})]})}var le=a(282),ue=a(285),pe=a(289),de=a(287),je=a(293),he=a(311),be=a(310),xe=a(153),me=a.n(xe),Oe=a(152),fe=a.n(Oe),ge="https://chat-server-challenge.herokuapp.com",ve=Object(le.a)({messageArea:{height:"471px",overflowY:"auto"},chatGridLeft:{backgroundColor:"rgba(0, 0, 0, 0.03)",padding:"10px 20px",borderRadius:"30px"},chatGridRight:{backgroundColor:"aliceblue",padding:"10px 20px",borderRadius:"30px"}}),ye=function(e){var t=Object(d.f)();null==E.a.get("AUTH")&&t.push("/login");var a=Object(n.useState)(null),c=Object(x.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)(null),o=Object(x.a)(i,2),u=o[0],p=o[1],j=Object(n.useState)(null),m=Object(x.a)(j,2),f=m[0],g=m[1],v=Object(n.useState)(""),y=Object(x.a)(v,2),w=y[0],k=y[1],C=Object(n.useRef)(null);function T(){C.current&&C.current.scrollIntoView({block:"start",behavior:"smooth"})}function S(){if(""!==w){var t={contactId:e.match.params.id,message:w,sentDate:"2017-05-15T13:09:02.035Z"};fetch("".concat(ge,"/contacts/").concat(e.match.params.id,"/send"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t),credentials:"include"}).then((function(){k("")}))}}Object(n.useEffect)((function(){function t(){return a.apply(this,arguments)}function a(){return(a=Object(b.a)(h.a.mark((function t(){var a,n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(ge,"/contacts/").concat(e.match.params.id,"/history"),{method:"GET",headers:{"content-type":"application/json"},credentials:"include"});case 2:return a=t.sent,t.next=5,a.json();case 5:n=t.sent,s(n),T();case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(){return(n=Object(b.a)(h.a.mark((function e(){var t,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(ge,"/profile"),{method:"GET",headers:{"content-type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,p(a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(){return(c=Object(b.a)(h.a.mark((function t(){var a,n;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(ge,"/contacts/").concat(e.match.params.id),{method:"GET",headers:{"content-type":"application/json"},credentials:"include"});case 2:return a=t.sent,t.next=5,a.json();case 5:n=t.sent,g(n);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}t(),function(){n.apply(this,arguments)}(),function(){c.apply(this,arguments)}(),T(),Object($.a)(ge).on("chat message",(function(){t()}))}),[e.match.params.id]);var I=function(){var e=Object(b.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),t.push("/");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.preventDefault(),null!=E.a.get("AUTH")&&(E.a.remove("AUTH"),t.push("/login"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=ve();return Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{style:{position:"absolute",left:"0px",top:"4px",color:"white"},children:Object(l.jsx)(Z.a,{size:"large",onClick:I,color:"inherit",children:Object(l.jsx)(fe.a,{})})}),Object(l.jsx)("div",{style:{position:"absolute",right:"0",top:"4px",color:"white"},children:Object(l.jsx)(Z.a,{size:"large",onClick:A,color:"inherit",children:Object(l.jsx)(ee.a,{})})}),Object(l.jsxs)(ue.a,{item:!0,style:{width:"100%",bgcolor:"background.paper"},children:[r&&Object(l.jsxs)(de.a,{className:D.messageArea,children:[r.messages.map((function(t){return Object(l.jsx)(je.a,{children:Object(l.jsxs)(ue.a,{container:!0,children:[Object(l.jsxs)(ue.a,{item:!0,xs:12,className:e.match.params.id===t.contactId?D.chatGridLeft:D.chatGridRight,children:[u&&f&&Object(l.jsx)(be.a,{alt:u.username,src:e.match.params.id===t.contactId?f.avatar:u.avatar,style:{float:e.match.params.id===t.contactId?"left":"right",margin:e.match.params.id===t.contactId?"0 16px 0 0":"0 0 0 16px"}}),Object(l.jsx)(he.a,{style:{margin:"8px 0"},align:e.match.params.id===t.contactId?"left":"right",primary:t.message})]}),Object(l.jsx)(ue.a,{item:!0,xs:12,children:Object(l.jsx)(he.a,{align:e.match.params.id===t.contactId?"left":"right",secondary:(a=t.sentDate,new Date(a).toLocaleTimeString([]))})})]})},t.id);var a})),Object(l.jsx)("div",{ref:C,style:{float:"left",clear:"both"}})]}),Object(l.jsxs)(ue.a,{container:!0,style:{padding:"20px",position:"absolute",bottom:"0px",borderTop:"1px solid rgba(0,0,0,0.1)"},children:[Object(l.jsx)(ue.a,{item:!0,xs:11,children:Object(l.jsx)(pe.a,{onChange:function(e){k(e.target.value)},value:w,id:"outlined-basic",label:"Messaggio",fullWidth:!0,variant:"outlined",onKeyPress:function(e){"Enter"===e.key&&S()&&T()}},"inputMessage")}),Object(l.jsx)(ue.a,{item:!0,xs:1,align:"right",style:{margin:"auto"},children:Object(l.jsx)(O.a,{onClick:function(){return S()&&T()},color:"primary","aria-label":"add",children:Object(l.jsx)(me.a,{})})})]})]})]})};function we(){return Object(l.jsx)(p.a,{children:Object(l.jsxs)("div",{children:[Object(l.jsx)(u,{}),Object(l.jsxs)(d.c,{children:[Object(l.jsx)(d.a,{exact:!0,path:"/",component:oe}),Object(l.jsx)(d.a,{path:"/login",component:D}),Object(l.jsx)(d.a,{path:"/chat/:id",component:ye})]})]})})}r.a.render(Object(l.jsx)(p.a,{children:Object(l.jsx)("div",{style:{position:"absolute",height:"640px",width:"360px",left:"50%",top:"50%",transform:"translate(-50%, -50%)",boxShadow:"5px 10px 18px #888888"},children:Object(l.jsx)(we,{})})}),document.getElementById("root"))}},[[195,1,2]]]);
//# sourceMappingURL=main.c5087849.chunk.js.map